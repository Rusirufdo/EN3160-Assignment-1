import numpy as np
import matplotlib.pyplot as plt
import cv2 as cv

img_orig = cv.imread(r"C:\Users\Rusiru_fdo\Desktop\a1images\a1q5images\im01small.png", cv.IMREAD_COLOR)
if img_orig is None:
    raise FileNotFoundError("Original image not found at given path")

img_rgb = cv.cvtColor(img_orig, cv.COLOR_BGR2RGB)

def ssd(img1, img2):
    img1 = img1.astype(np.float32)
    img2 = img2.astype(np.float32)
    return np.sum((img1 - img2) ** 2)

def zooming(original_image, zoom_factor):
    height, width, channels = original_image.shape
    zoomed_height = int(height * zoom_factor)
    zoomed_width = int(width * zoom_factor)
    zoomed_image = np.zeros((zoomed_height, zoomed_width, channels), dtype=np.uint8)
    
    y_scale = height / zoomed_height
    x_scale = width / zoomed_width
    
    for i in range(zoomed_height):
        for j in range(zoomed_width):
            original_y = i * y_scale
            original_x = j * x_scale
            
            x1, y1 = int(original_x), int(original_y)
            x2, y2 = min(x1 + 1, width - 1), min(y1 + 1, height - 1)
            
            weight_x = original_x - x1
            weight_y = original_y - y1
            
            pixel_interpolated = (
                (1 - weight_x) * (1 - weight_y) * original_image[y1, x1] +
                weight_x * (1 - weight_y) * original_image[y1, x2] +
                (1 - weight_x) * weight_y * original_image[y2, x1] +
                weight_x * weight_y * original_image[y2, x2]
            )
            
            zoomed_image[i, j] = np.clip(pixel_interpolated, 0, 255).astype(np.uint8)
    
    print("Shape of original image: ", original_image.shape)
    print("Shape of the zoomed image: ", zoomed_image.shape)
    
    zoomed_image_rgb = cv.cvtColor(zoomed_image, cv.COLOR_BGR2RGB)
    
    plt.figure(figsize=(10, 6))
    plt.subplot(121)
    plt.imshow(img_rgb)
    plt.title('Original Image')
    plt.axis('off')
    plt.subplot(122)
    plt.imshow(zoomed_image_rgb)
    plt.title('Zoomed Image')
    plt.axis('off')
    plt.show()
    
    img_BIG = cv.imread(r"C:\Users\Rusiru_fdo\Desktop\a1images\a1q5images\im01.png", cv.IMREAD_COLOR)
    if img_BIG is None:
        raise FileNotFoundError("Image 'im04.png' not found")
    
    img_BIG_resized = cv.resize(img_BIG, (zoomed_width, zoomed_height))
    print("SSD value between original and zoomed images: ", ssd(img_BIG_resized, zoomed_image))
    
    return zoomed_image

zoom_factor = 4
print('Zooming Factor: ', zoom_factor)
zoomed_image = zooming(img_orig, zoom_factor)
cv.imwrite('im04small_zoomed_by_bilinear_interpolation.png', zoomed_image)
